var discordWidget=discordWidget||(function(){var a={};return{init:function(b){b.serverId=typeof b.serverId!=="undefined"?b.serverId:false;b.title=typeof b.title!=="undefined"?b.title:false;b.join=typeof b.join!=="undefined"?b.join:true;b.alphabetical=typeof b.alphabetical!=="undefined"?b.alphabetical:false;b.theme=typeof b.theme!=="undefined"?b.theme:"light";b.hideChannels=typeof b.hideChannels!=="undefined"?b.hideChannels:false;b.showAllUsers=typeof b.showAllUsers!=="undefined"?b.showAllUsers:false;b.allUsersDefaultState=typeof b.allUsersDefaultState!=="undefined"?b.allUsersDefaultState:true;a.serverId=b.serverId;a.title=b.title;a.join=b.join;a.alphabetical=b.alphabetical;a.theme=b.theme;a.hideChannels=b.hideChannels;a.showAllUsers=b.showAllUsers;a.allUsersDefaultState=b.allUsersDefaultState},render:function(){if(window.jQuery){c()}else{var b=document.createElement("script");b.type="text/javascript";b.src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js";document.head.appendChild(b);b.onload=function(){c()}}function c(){var j="";switch(a.theme){case"dark":j="dark.min.css";break;case"light":j="light.min.css";break;case"none":j="none.min.css";break;default:j="light.min.css"}$("head").append('<link rel="stylesheet" href="http://discord.knightsoftheblade.com/'+j+'" type="text/css" />');var g="http://discordapp.com/api/servers/"+a.serverId+"/embed.json";var h=new XMLHttpRequest();h.onreadystatechange=function(){if(h.readyState==4&&h.status==200){var k=JSON.parse(h.responseText);i(k,a);if(!a.allUsersDefaultState){$(".discord-allusers").toggle();$(".discord-allusers-toggle").html("&#9656; Online Users")}$(".discord-allusers-toggle").click(function(){$(".discord-allusers").toggle(100,function(){if($(".discord-allusers").is(":visible")){$(".discord-allusers-toggle").html("&#9662; Online Users")}else{$(".discord-allusers-toggle").html("&#9656; Online Users")}})})}else{if(h.readyState==4){i(false,a)}}};h.open("GET",g,true);h.send();function d(l,k){if(l.position<k.position){return -1}if(l.position>k.position){return 1}return 0}function f(k){return'<li class="discord-channel">'+k+'</li><ul class="discord-userlist">'}function e(m,k){var l="";if(m.game){l=" - "+m.game.name}if(m.channel_id==k){if(m.status!="online"){return'<li class="discord-user"><img src="'+m.avatar_url+'" class="discord-avatar"/><div class="discord-user-status discord-idle"></div>'+m.username+"<span>"+l+"</span></li>"}else{return'<li class="discord-user"><img src="'+m.avatar_url+'" class="discord-avatar"/><div class="discord-user-status discord-online"></div>'+m.username+"<span>"+l+"</span></li>"}}else{return""}}function i(x,m){var y=$(".discord-widget")[0];var z='<ul class="discord-tree"></ul><p class="discord-users-online"></p><p class="discord-join"></p><div class="discord-fade"></div>';var t="";var q="";var k,v,w;var u,l,o,n;if(m.title!==false){y.innerHTML='<div class="discord-title"><h3>'+m.title+"</h3></div>"+z;k=$(".discord-tree")[0]}else{y.innerHTML=z;k=$(".discord-tree")[0];k.style.marginTop="0"}if(!x){k.innerHTML='<span class="discord-error">Invalid Server ID</span>';return}v=$(".discord-users-online")[0];w=$(".discord-join")[0];if(m.alphabetical){u=[];n=[];for(var s=0;s<x.channels.length;s++){o=false;for(var r=0;r<m.hideChannels.length;r++){if(x.channels[s].name.includes(m.hideChannels[r])){o=true}}if(!o){u.push(x.channels[s])}else{n.push(x.channels[s].id)}}for(var s=0;s<u.length;s++){t+=f(u[s].name);for(var r=0;r<x.members.length;r++){t+=e(x.members[r],u[s].id)}t+="</ul>"}}else{u=[];n=[];for(var s=0;s<x.channels.length;s++){o=false;for(var r=0;r<m.hideChannels.length;r++){if(x.channels[s].name.includes(m.hideChannels[r])){o=true}}if(!o){u.push(x.channels[s])}else{n.push(x.channels[s].id)}}u.sort(d);for(var s=0;s<u.length;s++){t+=f(u[s].name);for(var r=0;r<x.members.length;r++){t+=e(x.members[r],u[s].id)}t+="</ul>"}}if(m.showAllUsers){t+='<li class="discord-channel discord-allusers-toggle">&#9662; Online Users</li><ul class="discord-userlist discord-allusers">';for(var s=0;s<x.members.length;s++){if(!x.members[s].channel_id||$.inArray(x.members[s].channel_id,n)>=0){t+=e(x.members[s],x.members[s].channel_id)}}t+="</ul>"}var A="";if(x.instant_invite!="null"){A='<p class="discord-join"><a href="'+x.instant_invite+'">Join Server</a></p>'}k.innerHTML=t;v.innerHTML="Users Online: "+x.members.length;if(m.join){w.innerHTML=A}else{w.style.display="none"}}$.ajax({url:"http://discord.knightsoftheblade.com:3032",type:"POST"})}}}}());