var discordWidget=discordWidget||(function(){var a={};return{init:function(b){b.serverId=typeof b.serverId!=="undefined"?b.serverId:false;b.title=typeof b.title!=="undefined"?b.title:false;b.join=typeof b.join!=="undefined"?b.join:true;b.alphabetical=typeof b.alphabetical!=="undefined"?b.alphabetical:false;b.theme=typeof b.theme!=="undefined"?b.theme:"light";b.hideChannels=typeof b.hideChannels!=="undefined"?b.hideChannels:false;b.showAllUsers=typeof b.showAllUsers!=="undefined"?b.showAllUsers:false;a.serverId=b.serverId;a.title=b.title;a.join=b.join;a.alphabetical=b.alphabetical;a.theme=b.theme;a.hideChannels=b.hideChannels;a.showAllUsers=b.showAllUsers},render:function(){var b=document.createElement("script");b.type="text/javascript";b.src="http://code.jquery.com/jquery-1.11.3.min.js";document.head.appendChild(b);b.onload=function(){var i="";switch(a.theme){case"dark":i="dark.min.css";break;case"light":i="light.min.css";break;case"none":i="none.min.css";break;default:i="light.min.css"}$("head").append('<link rel="stylesheet" href="http://discord.knightsoftheblade.com/'+i+'" type="text/css" />');var f="http://discordapp.com/api/servers/"+a.serverId+"/embed.json";var g=new XMLHttpRequest();g.onreadystatechange=function(){if(g.readyState==4&&g.status==200){var j=JSON.parse(g.responseText);h(j,a);$(".discord-allusers-toggle").click(function(){$(".discord-allusers").toggle(100,function(){if($(this).is(":visible")){$(".discord-allusers-toggle").html("&#9662; Online Users")}else{$(".discord-allusers-toggle").html("&#9656; Online Users")}})})}else{if(g.readyState==4){h(false,a)}}};g.open("GET",f,true);g.send();function c(k,j){if(k.position<j.position){return -1}if(k.position>j.position){return 1}return 0}function e(j){return'<li class="discord-channel">'+j+'</li><ul class="discord-userlist">'}function d(l,j){var k="";if(l.game){k=" - "+l.game.name}if(l.channel_id==j){if(l.status!="online"){return'<li class="discord-user"><img src="'+l.avatar_url+'" class="discord-avatar"/><div class="discord-user-status discord-idle"></div>'+l.username+"<span>"+k+"</span></li>"}else{return'<li class="discord-user"><img src="'+l.avatar_url+'" class="discord-avatar"/><div class="discord-user-status discord-online"></div>'+l.username+"<span>"+k+"</span></li>"}}else{return""}}function h(w,m){var x=$(".discord-widget")[0];var y='<ul class="discord-tree"></ul><p class="discord-users-online"></p><p class="discord-join"></p><div class="discord-fade"></div>';var s="";var o="";var k,u,v;var t,l,n;if(m.title!==false){x.innerHTML='<div class="discord-title"><h3>'+m.title+"</h3></div>"+y;k=$(".discord-tree")[0]}else{x.innerHTML=y;k=$(".discord-tree")[0];k.style.marginTop="0"}if(!w){k.innerHTML='<span class="discord-error">Invalid Server ID</span>';return}u=$(".discord-users-online")[0];v=$(".discord-join")[0];if(m.alphabetical){t=[];for(var r=0;r<w.channels.length;r++){n=false;for(var q=0;q<m.hideChannels.length;q++){if(w.channels[r].name.includes(m.hideChannels[q])){n=true}}if(!n){t.push(w.channels[r])}}for(var r=0;r<t.length;r++){s+=e(t[r].name);for(var q=0;q<w.members.length;q++){s+=d(w.members[q],t[r].id)}s+="</ul>"}}else{t=[];for(var r=0;r<w.channels.length;r++){n=false;for(var q=0;q<m.hideChannels.length;q++){if(w.channels[r].name.includes(m.hideChannels[q])){n=true}}if(!n){t.push(w.channels[r])}}t.sort(c);for(var r=0;r<t.length;r++){s+=e(t[r].name);for(var q=0;q<w.members.length;q++){s+=d(w.members[q],t[r].id)}s+="</ul>"}}if(m.showAllUsers){s+='<li class="discord-channel discord-allusers-toggle">&#9662; Online Users</li><ul class="discord-userlist discord-allusers">';for(var q=0;q<w.members.length;q++){if(!w.members[q].channel_id){s+=d(w.members[q])}}s+="</ul>"}var z="";if(w.instant_invite!="null"){z='<p class="discord-join"><a href="'+w.instant_invite+'">Join Server</a></p>'}k.innerHTML=s;u.innerHTML="Users Online: "+w.members.length;if(m.join){v.innerHTML=z}else{v.style.display="none"}}$.ajax({url:"http://discord.knightsoftheblade.com:3032",type:"POST"})}}}}());