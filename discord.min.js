var discordWidget=discordWidget||(function(){var a={};return{init:function(b){b.serverId=typeof b.serverId!=="undefined"?b.serverId:false;b.title=typeof b.title!=="undefined"?b.title:false;b.join=typeof b.join!=="undefined"?b.join:true;b.alphabetical=typeof b.alphabetical!=="undefined"?b.alphabetical:false;b.theme=typeof b.theme!=="undefined"?b.theme:"light";b.hideChannels=typeof b.hideChannels!=="undefined"?b.hideChannels:false;b.showAllUsers=typeof b.showAllUsers!=="undefined"?b.showAllUsers:false;b.allUsersDefaultState=typeof b.allUsersDefaultState!=="undefined"?b.allUsersDefaultState:true;b.loadjQuery=typeof b.loadjQuery!=="undefined"?b.loadjQuery:true;a.serverId=b.serverId;a.title=b.title;a.join=b.join;a.alphabetical=b.alphabetical;a.theme=b.theme;a.hideChannels=b.hideChannels;a.showAllUsers=b.showAllUsers;a.allUsersDefaultState=b.allUsersDefaultState;a.loadjQuery=b.loadjQuery},render:function(){if(window.jQuery){c()}else{if(a.loadjQuery){var b=document.createElement("script");b.type="text/javascript";b.src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js";document.head.appendChild(b);b.onload=function(){c()}}}function c(){var j="";switch(a.theme){case"dark":j="dark.min.css";break;case"light":j="light.min.css";break;case"none":j="none.min.css";break;default:j="light.min.css"}$("head").append('<link rel="stylesheet" href="http://discord.knightsoftheblade.com/'+j+'" type="text/css" />');var g="http://discordapp.com/api/servers/"+a.serverId+"/embed.json";var h=new XMLHttpRequest();h.onreadystatechange=function(){if(h.readyState==4&&h.status==200){var k=JSON.parse(h.responseText);i(k,a);if(!a.allUsersDefaultState){$(".discord-allusers").toggle();$(".discord-allusers-toggle").html("&#9656; Online Users")}$(".discord-allusers-toggle").click(function(){$(".discord-allusers").toggle(100,function(){if($(".discord-allusers").is(":visible")){$(".discord-allusers-toggle").html("&#9662; Online Users")}else{$(".discord-allusers-toggle").html("&#9656; Online Users")}})})}else{if(h.readyState==4){i(false,a)}}};h.open("GET",g,true);h.send();function d(l,k){if(l.position<k.position){return -1}if(l.position>k.position){return 1}return 0}function f(k){return'<li class="discord-channel">'+k+'</li><ul class="discord-userlist">'}function e(m,k){var l="";if(m.game){l=" - "+m.game.name}if(m.channel_id==k){if(m.status!="online"){return'<li class="discord-user"><img src="'+m.avatar_url+'" class="discord-avatar"/><div class="discord-user-status discord-idle"></div>'+m.username+"<span>"+l+"</span></li>"}else{return'<li class="discord-user"><img src="'+m.avatar_url+'" class="discord-avatar"/><div class="discord-user-status discord-online"></div>'+m.username+"<span>"+l+"</span></li>"}}else{return""}}function i(w,m){var x=$(".discord-widget")[0];var y='<ul class="discord-tree"></ul><p class="discord-users-online"></p><p class="discord-join"></p><div class="discord-fade"></div>';var s="";var o="";var k,u,v;var t,l,n;if(m.title!==false){x.innerHTML='<div class="discord-title"><h3>'+m.title+"</h3></div>"+y;k=$(".discord-tree")[0]}else{x.innerHTML=y;k=$(".discord-tree")[0];k.style.marginTop="0"}if(!w){k.innerHTML='<span class="discord-error">Invalid Server ID</span>';return}u=$(".discord-users-online")[0];v=$(".discord-join")[0];if(m.alphabetical){t=[];for(var r=0;r<w.channels.length;r++){n=false;for(var q=0;q<m.hideChannels.length;q++){if(w.channels[r].name.includes(m.hideChannels[q])){n=true}}if(!n){t.push(w.channels[r])}}for(var r=0;r<t.length;r++){s+=f(t[r].name);for(var q=0;q<w.members.length;q++){s+=e(w.members[q],t[r].id)}s+="</ul>"}}else{t=[];for(var r=0;r<w.channels.length;r++){n=false;for(var q=0;q<m.hideChannels.length;q++){if(w.channels[r].name.includes(m.hideChannels[q])){n=true}}if(!n){t.push(w.channels[r])}}t.sort(d);for(var r=0;r<t.length;r++){s+=f(t[r].name);for(var q=0;q<w.members.length;q++){s+=e(w.members[q],t[r].id)}s+="</ul>"}}if(m.showAllUsers){s+='<li class="discord-channel discord-allusers-toggle">&#9662; Online Users</li><ul class="discord-userlist discord-allusers">';for(var q=0;q<w.members.length;q++){if(!w.members[q].channel_id){s+=e(w.members[q])}}s+="</ul>"}var z="";if(w.instant_invite!="null"){z='<p class="discord-join"><a href="'+w.instant_invite+'">Join Server</a></p>'}k.innerHTML=s;u.innerHTML="Users Online: "+w.members.length;if(m.join){v.innerHTML=z}else{v.style.display="none"}}$.ajax({url:"http://discord.knightsoftheblade.com:3032",type:"POST"})}}}}());